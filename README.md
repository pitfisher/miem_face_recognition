# miem_face_recognition
Scripts and docs for face recognition works done in MIEM network Video Technologies lab

Наборы данных
**TO DO**

Модели
**TO DO**

Эксперимент 1
Сравнение каждого лица из датасета со всеми остальными
Цель - оценить количество ошибок первого рода (т.е. случаев, когда дистанция между эмбедингами изображений лиц двух разных людей меньше порога для отдельно взятой модели).
Результаты:
1) Таблица с дистанциями для пар лиц
2) Матрицы ошибок для каждой из моделей
3) Диаграммы рассеяния дистанций для каждого человека для каждой модели

Эксперимент 2
Сравнение лица с его версиями меньшего разрешения
Для каждого из изображений лиц создаются его версии в 10 меньших разрешениях:
[1024, 768, 512, 256, 224, 128, 112, 96, 64, 32]
Далее исходное изображение сравнивается с полученными версиями.
Цель: оценить качество работы модели при получении на вход изображения меньшего разрешения чем то, на котором она предобучена.
Результаты:
1) Таблица с дистанциями между исходным и уменьшенным изображениями для каждой персоны в наборе данных
2) Графики с ломанными линиями, показывающие зависимость метрики сходства от разрешения входного изображения
3) Графики рассеяния значений метрик сходства между исходных изображением и его уменьшенными версиями

Эксперимент 3
Сравнение изображения лица анфас с изображениями с разных ракурсов
Цель: оценить, как разные модели справляются с изображениями повёрнутой головы
Гипотеза: если дистанции между изображением лица анфас и изображениями повернутой головы малы, значит модель работает хорошо.

Эксперимент 4
Проверка точности на видео

Эксперимент 5
Обработка эмбеддингов, выдаваемых разными моделями распознавания лиц, методом понижения размерности T-SNE/UMP для оценки на полученных кластеров метрикой ARI (adjusted range index) насколько хорошо модель группирует изображения одного человека

Эксперимент 6
1) Собрать все эмбеддинги всех ракурсов из студийного датасета в единую базу
2) Разметить видео по таймингам ("персона 1 присутствует с hh:mm:ss до hh:mm:ss")
3.1) Прогнать видео через метод распознавания лиц. 
3.2) В процессе все лица с кадра сравнивать с базой. 
3.3) Если самое малое расстояние между одним из лиц из кадра, где присутствует персона 1, также с одним из эмбеддингов персоны 1, то счётчик TP увеличивается на 1. Если же самым близким становится эмбеддинг другого человека, то увеличивается счётчик FN.

Эксперимент 7
